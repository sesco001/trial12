<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div class="navbar">
    <h2>Admin Dashboard</h2>
    <button onclick="logout()">Logout</button>
  </div>
  <div class="container">
    <h3>Post Assignment</h3>
    <form id="post">
      <input name="title" placeholder="Title" required>
      <textarea name="description" placeholder="Description"></textarea>
      <label><input type="checkbox" name="premiumOnly"> Premium only</label>
      <button>Post</button>
    </form>

    <h3>Users</h3>
    <div id="users"></div>
  </div>

  <script src="js/app.js"></script>
  <script>
  async function loadUsers() {
    const res = await fetch(API + '/admin/users', { headers: { Authorization: 'Bearer ' + token }});
    const data = await res.json();
    const list = document.getElementById('users');
    list.innerHTML = '';
    data.forEach(u=>{
      const div = document.createElement('div');
      div.className = 'card';
      div.innerHTML = `${u.email} | Verified: ${u.verified} <button onclick="verify('${u._id}')">Verify</button>`;
      list.appendChild(div);
    });
  }

  async function verify(id) {
    await apiPost('/admin/verify-user', { userId: id });
    loadUsers();
  }

  document.getElementById('post').addEventListener('submit', async e=>{
    e.preventDefault();
    const fd = new FormData(e.target);
    const body = { title: fd.get('title'), description: fd.get('description'), premiumOnly: fd.get('premiumOnly')==='on' };
    await apiPost('/admin/post', body);
    alert("Assignment posted!");
  });

  loadUsers();
  </script>
</body>
</html>
